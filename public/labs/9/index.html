<!doctype html><html lang=en dir=ltr><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  Overview
  #

This lab is designed to give you some hands-on experience with Docker! By the end of this assignment, you should be able to:

Create and use a Docker container interactively and create a Dockerfile, which allows you to declaratively define your containers.

Keep track of your answers to the questions, as you&rsquo;ll need to submit them to Gradescope.

  Getting started with Docker
  #

You have a couple of options for 
  installing Docker. It is recommended to follow the &ldquo;Install using the apt repository&rdquo; section."><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="http://localhost:1313/labs/9/"><meta property="og:site_name" content="OCF Sysadmin DeCal"><meta property="og:title" content="Lab 9 - Containers (Docker)"><meta property="og:description" content="Overview # This lab is designed to give you some hands-on experience with Docker! By the end of this assignment, you should be able to:
Create and use a Docker container interactively and create a Dockerfile, which allows you to declaratively define your containers. Keep track of your answers to the questions, as you’ll need to submit them to Gradescope.
Getting started with Docker # You have a couple of options for installing Docker. It is recommended to follow the “Install using the apt repository” section."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="labs"><title>Lab 9 - Containers (Docker) | OCF Sysadmin DeCal</title><link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=http://localhost:1313/labs/9/><link rel=stylesheet href=/book.min.5d66a598a957a57db9eb1e614a4e20c2bc6f81b607613fa13e31fc22786d762f.css integrity="sha256-XWalmKlXpX256x5hSk4gwrxvgbYHYT+hPjH8Inhtdi8=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.0403a2d42fe34225c8453acedbee195570716c6bb2b50b5e1f122f9a21ed1302.js integrity="sha256-BAOi1C/jQiXIRTrO2+4ZVXBxbGuytQteHxIvmiHtEwI=" crossorigin=anonymous></script><script defer src=/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js integrity="sha256-b2+Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC+NdcPIvZhzk=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>OCF Sysadmin DeCal</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li><a href=/syllabus/>Syllabus</a></li><li><input type=checkbox id=section-7ca99bfa93ba9834254d62abc41412a4 class=toggle>
<label for=section-7ca99bfa93ba9834254d62abc41412a4 class=flex><a role=button class=flex-auto>Announcements</a></label><ul><li><a href=/announcements/week-0/>Week 0</a></li></ul></li><li><input type=checkbox id=section-a24c7a9ca0a1b2e25b73a598c9db1aa4 class=toggle checked>
<label for=section-a24c7a9ca0a1b2e25b73a598c9db1aa4 class=flex><a role=button class=flex-auto>Labs</a></label><ul><li><a href=/labs/1/>Lab 1 - Unix, the Shell, OSS</a></li><li><a href=/labs/2/>Lab 2 - Core Shell & Shell Scripting</a></li><li><a href=/labs/3/>Lab 3 - Packages and Packaging</a></li><li><a href=/labs/4/>Lab 4 - Processes and Services</a></li><li><a href=/labs/5/>Lab 5 - Introduction to Networking</a></li><li><a href=/labs/6/>Lab 6 - Web Servers</a></li><li><a href=/labs/7/>Lab 7 - Security Fundamentals</a></li><li><a href=/labs/8/>Lab 8 - Version Control and Backups</a></li><li><a href=/labs/9/ class=active>Lab 9 - Containers (Docker)</a></li><li><a href=/labs/10/>Lab 10 - Puppet</a></li><li><a href=/labs/11/>Lab 11 - Kubernetes</a></li><li><a href=/labs/12/>Lab 12 - CUDA</a></li></ul></li><li><a href=/staff/>Staff</a></li><li><a href=/resources/>Resources</a></li><li><a href=/archives/>Archives</a></li></ul><ul><li><a href=https://edstem.org target=_blank rel=noopener>Ed</a></li><li><a href=https://ocf.berkeley.edu target=_blank rel=noopener>OCF</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>Lab 9 - Containers (Docker)</h3><label for=toc-control></label></div></header><article class="markdown book-article"><h2 id=overview>Overview
<a class=anchor href=#overview>#</a></h2><p>This lab is designed to give you some hands-on experience with Docker! By the end of this assignment, you should be able to:</p><ul><li>Create and use a Docker container interactively and create a Dockerfile, which allows you to declaratively define your containers.</li></ul><p>Keep track of your answers to the questions, as you&rsquo;ll need to submit them to Gradescope.</p><h2 id=getting-started-with-docker>Getting started with Docker
<a class=anchor href=#getting-started-with-docker>#</a></h2><p>You have a couple of options for
<a href=https://docs.docker.com/v17.09/engine/installation/linux/docker-ce/ubuntu/>installing Docker</a>. It is recommended to follow the &ldquo;Install using the apt repository&rdquo; section.</p><p>After installing, run <code>sudo usermod -aG docker $USER</code>, then logout and login again. This adds your user to the docker group so you can run <code>docker</code> as a non-root user. This means you won’t have to type <code>sudo docker</code> all the time. This is optional but for the rest of the lab I’m going to assume that you did this.</p><h3 id=creating-your-first-docker-container>Creating your first Docker container
<a class=anchor href=#creating-your-first-docker-container>#</a></h3><p>To verify that you installed things correctly, try running:</p><p><code>docker run hello-world</code></p><p>You should see some friendly output like so:</p><pre tabindex=0><code>Unable to find image &#39;hello-world:latest&#39; locally
latest: Pulling from library/hello-world
1b930d010525: Pull complete
Digest: sha256:c3b4ada4687bbaa170745b3e4dd8ac3f194ca95b2d0518b417fb47e5879d9b5f
Status: Downloaded newer image for hello-world:latest

Hello from Docker!
This message shows that your installation appears to be working correctly.
...
</code></pre><p>This message shows that your installation appears to be working correctly. To generate this message, Docker took the following steps:</p><ol><li>The Docker client contacted the Docker daemon.</li><li>The Docker daemon pulled the “hello-world” image from the Docker Hub.</li><li>The Docker daemon created a new container from that image which runs the executable that produces the output you are currently reading.</li><li>The Docker daemon streamed that output to the Docker client, which sent it to your terminal.</li></ol><p>Some
<a href=https://docs.docker.com/get-started/#a-brief-explanation-of-containers>quick definitions</a> from Docker’s website:</p><p>An <strong>image</strong> is a lightweight, stand-alone, executable package that includes everything needed to run a piece of software, including the code, a runtime, libraries, environment variables, and config files. Images are useful primarily for their speed, but images can also be used as a base to be built on top of in future images, as you’ll see later with Dockerfiles. In the last example hello-world was the image used to test our docker installation.</p><p>A <strong>container</strong> is a runtime instance of an image—what the image becomes in memory when actually executed. It runs completely isolated from the host environment by default, only accessing host files and ports if configured to do so. A container gets created upon executing <code>docker run</code> on an image.</p><p>Be sure to read through the output from running the hello-world image to get an understanding of what the Docker daemon was doing.</p><h3 id=running-an-interactive-container>Running an interactive container
<a class=anchor href=#running-an-interactive-container>#</a></h3><p>Now, let&rsquo;s try to run a container interactively. This is useful if you ever need to play around and install stuff on a bare system without messing up your current system. Try running the following command:</p><p><code>docker run -it ubuntu:latest</code></p><p>The <code>-i</code> flag tells docker to keep <code>STDIN</code> open to your container, and the <code>-t</code> flag allocates a
<a href=https://en.wikipedia.org/wiki/Pseudoterminal>pseudo TTY</a> for you. Basically you need both for you to have a shell into your newly started container. Try installing some packages from <code>apt</code> or just play around. It should look like a bare Linux system.</p><p>You can exit the container with CTRL+D.</p><h4 id=questions>Questions
<a class=anchor href=#questions>#</a></h4><ol><li>What user are you logged in as by default in the container?</li><li>If you start and then exit an interactive container, and then use the <code>docker run -it ubuntu:latest</code> command again; is it the same container? How can you tell?</li></ol><h3 id=dockerfiles>Dockerfiles
<a class=anchor href=#dockerfiles>#</a></h3><p>The natural question is, how are Docker images built? A <strong>Dockerfile</strong> is like the source code of an image. Rather, a Dockerfile allows you to define an image by specifying all of the commands you would type manually to create an image. Docker can then build images from a specified Dockerfile. These Dockerfiles can be put into version control and the images uploaded to online repositories. Can you see how this can be useful for deploying your application?</p><p>Dockerfiles are very powerful and have many different commands and features. We’ll go over a basic example, but you should check out the
<a href=https://docs.docker.com/engine/reference/builder/>reference page</a> if you are trying to do anything more complex.</p><p>Let&rsquo;s jump in. We&rsquo;re going to create an image that deploys your new startup&rsquo;s app, Missile! Unfortunately, so far you only have the opening animation complete, and the source code is in <code>b10/missile.py</code> in repo -
<a href=https://github.com/0xcf/decal-labs>decal-labs</a>.</p><p>Your program has a couple of dependencies. Namely, it requires Python and the python packages <code>termcolor</code> and <code>pyfiglet</code> to be installed. Here is a <strong>Dockerfile</strong> that puts those requirements into code, by installing Python 3 and the packages onto a base Fedora Linux image.</p><pre tabindex=0><code># Specify Fedora Linux as base image
FROM fedora:latest

# Install Python with yum (Fedora&#39;s Package Manager)
# Install required Python packages
RUN yum update -y &amp;&amp; yum install -y python3 python3-pip &amp;&amp; \
    python3 -m pip install pyfiglet termcolor

# Add the missile.py file to the final image
ADD missile.py /

# Specify the command to be run on container creation
CMD [&#34;/usr/bin/python3&#34;, &#34;missile.py&#34;]
</code></pre><p>Note: there are some “best practices” for writing Dockerfiles that the above example doesn’t use, because it’s a basic example. If you’re interested in this stuff, check out
<a href=https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-practices/>this article</a>.</p><p>Take a moment to appreciate how cool this is. We have a completely different Linux distribution with an application running on our system that can all be spun up with a single command. Now, when (if?) your startup finally takes off, scaling up will be a breeze!</p><p>Make sure you have both files named <code>missile.py</code> and <code>Dockerfile</code> respectively then build the image with the following command:</p><p><code>docker build -t missile:latest .</code></p><p>This tells Docker to look in the current directory for a <code>Dockerfile</code> to build, and builds it. The <code>-t</code> flag tells Docker to tag this build with the name <code>missile:latest</code>. Note that building the missile image will take a couple of minutes to complete.</p><p>You can see all of the images you’ve built on your machine with the <code>docker images</code> command.</p><h4 id=questions-1>Questions
<a class=anchor href=#questions-1>#</a></h4><ol><li>Run the image you just built with no flags. What do you observe?</li><li>Write and build a <code>Dockerfile</code> based on <code>ubuntu:bionic</code> that installs the packages <code>fortune</code> and <code>fortunes-min</code> and runs the fortune executable (located in <code>/usr/games/fortune</code> after you install it). Note that you won’t need to use the <code>-it</code> flags when you run the container as fortune doesn’t need <code>STDIN</code>. Submit your <code>Dockerfile</code> with this lab. Hint: if you’re having trouble writing your Dockerfile, try booting an interactive container and installing both packages. How can you translate what you did interactively to a Dockerfile?</li><li>Paste the output of running <code>docker images</code> command after completing questions 1 and 2.</li></ol><h3 id=dockerizing-a-web-server>Dockerizing a Web Server
<a class=anchor href=#dockerizing-a-web-server>#</a></h3><p>For our last trick, we’re going to use Docker to run multiple Apache web servers inside containers.</p><p>For simplicity, you will not have to write this <code>Dockerfile</code>. Go ahead and pull the <code>httpd</code> image from Docker Hub. Now, it’s your job to figure out how to run three instances of the Apache containers on your machine.</p><p>Docker creates a separate network for containers, so you will need to forward your host port to your container’s port (this is called
<a href=https://en.wikipedia.org/wiki/Port_forwarding>port forwarding</a>, or port mapping). The container is listening on port 80 by default. It is your job to run each instance on ports 4000, 4001, and 4002. I recommend running the containers in detached mode with the <code>-d</code> flag. Detached mode will run a container in the background and print its new container ID. You can view running containers with <code>docker ps</code>.</p><p>Hints:</p><ul><li>The <code>-p</code> flag takes in a colon separated pair of <code>HOST_PORT:CONTAINER_PORT</code> (it can actually accept a ton of more options, but don’t worry about that for now).</li><li>You can see if you were successful by executing <code>curl localhost:4000</code> on your student VM. Check that you;&rsquo;ve also done it correctly for ports <code>4001</code> and <code>4002</code>.</li><li>Refer to the Docker commands slide if you&rsquo;re stuck!</li></ul><h4 id=questions-2>Questions
<a class=anchor href=#questions-2>#</a></h4><ol><li>While your three containerized Apache web servers are running in detached mode, paste the output of <code>docker ps</code>.</li><li>Observe that in the output of <code>docker ps</code>, each container has an associated container ID. Explain why containers have IDs/Names rather than being named after the image, for example <code>httpd</code>.</li><li>Now go ahead and stop your containers. Paste the command you used to stop one of the containers.</li></ol><p>Congratulations! You’ve successfully Dockerized and ran a web server without affecting your setup on your machine :) There’s a lot more about Docker and containers to learn about, but I hope this was enough to wrap your head around the basic concepts and get some experience working with it.</p><p>For further reading -
<a href=https://docs.docker.com/>official documentation</a></p></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><div class="flex flex-wrap justify-between"><span><a href=/labs/8/ class="flex align-center book-icon"><img src=/svg/backward.svg class=book-icon alt=Previous title="Lab 8 - Version Control and Backups">
<span>Lab 8 - Version Control and Backups</span>
</a></span><span><a href=/labs/10/ class="flex align-center book-icon"><span>Lab 10 - Puppet</span>
<img src=/svg/forward.svg class=book-icon alt=Next title="Lab 10 - Puppet"></a></span></div><div class="col-lg-12 text-center"><p style=display:flex;justify-content:center;align-items:center><a href=https://www.janestreet.com class=no-underline><img src=/jane-street.svg style=height:50px>
</a><span style=padding-left:10px ;>Thanks to
<a href=https://www.janestreet.com>Jane Street</a> for supporting the DeCal.</span></p><p style=display:flex;justify-content:center;align-items:center><a href=https://www.ocf.berkeley.edu class=no-underline><img src=https://www.ocf.berkeley.edu/hosting-logos/ocf-hosted-penguin.svg alt="Hosted by the OCF" style=height:50px style=border:0></a>
<span style=padding-left:10px ;>Copyright &copy; 2017-2025
<a href=https://www.ocf.berkeley.edu>Open Computing Facility </a>and
<a href=https://xcf.berkeley.edu>eXperimental Computing Facility</a></span></p><p><span>This website and its course materials are licensed under the terms of the
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0
</a>License.
<a href=https://github.com/0xcf/decal-web/>Source Code </a>available on GitHub</span></p></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div></main></body></html>